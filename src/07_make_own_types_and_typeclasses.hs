{-# OPTIONS -Wall -Werror #-}

import qualified Data.Map as Map

---_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/---
--   ã€€å‹ã‚„å‹ã‚¯ãƒ©ã‚¹ã‚’è‡ªåˆ†ã§ä½œã‚ã†ã€€    --
---_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/---

-------------------------------
-- æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã™ã‚‹
-------------------------------

{-
    è‡ªä½œã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ä½œã‚‹æ–¹æ³•ã® 1 ã¤ã¯ data ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ã†ã“ã¨ã§ã™ã€‚
    ã¾ãšã¯ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ Bool å‹ã®å®šç¾©ãŒã©ã†ãªã£ã¦ã„ã‚‹ã‹è¦‹ã¦ã¿ã‚ˆã†ã€‚

        data Bool = False | True

    ã“ã®ã‚ˆã†ã« data ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ã†ã¨ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã™ã‚‹æ§‹æ–‡ã«ãªã‚‹ã€‚
    ç­‰å·ã®å‰ã®éƒ¨åˆ†ã¯å‹ã®åå‰ã€ã“ã“ã§ã¯ Bool ã‚’è¡¨ã™ã€‚
    ç­‰å·ã®å¾Œã®éƒ¨åˆ†ã¯å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚ã‚‹ã€‚

    å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã€ã“ã®å‹ãŒå–ã‚Šã†ã‚‹å€¤ã®ç¨®é¡ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã€‚è¨˜å· | ã¯ã€Œã¾ãŸã¯ã€ã®æ„å‘³ã€‚
    ã¨ã„ã†ã‚ã‘ã§ã€ã“ã®å‹å®£è¨€ã¯ã€ŒBool å‹ã¯ True ã¾ãŸã¯ã€€False ã®å€¤ã‚’å–ã‚Šã†ã‚‹ã€ã¨èª­ã‚ã‚‹ã€‚

    å‹åã¨å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã©ã¡ã‚‰ã‚‚å¤§æ–‡å­—ã§å§‹ã¾ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

    åŒæ§˜ã«ã€Int å‹ã¯ã“ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã¨ã¿ãªã›ã‚‹ã€‚

        data Int = -2147483648 | -2147483647 | ... | -1 | 0 | 1 | 2 | ... | 2147483647

    æœ€åˆã¨æœ€å¾Œã®å€¤ã¯ Int ãŒå–ã‚Šã†ã‚‹æœ€å°å€¤ã¨æœ€å¤§å€¤ã§ã‚ã‚‹ï¼ˆå®Ÿéš›ã® Int ã¯ã“ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ï¼‰ã€‚

    ã•ã¦ã€Haskell ã§å›³å½¢ã‚’è¡¨ã™ã«ã¯ã©ã†ã™ã‚‹ï¼Ÿ
    ã‚¿ãƒ—ãƒ«ã‚’ä½¿ã†ã¨ã„ã†æ‰‹ãŒã‚ã‚‹ã€‚ä¾‹ãˆã°ã€å††ã¯ (43.1, 55.0, 10.4) ã¨è¡¨ã›ã‚‹ã€‚
    1 ã¤ç›®ã¨ 2 ã¤ç›®ãŒç¸ã®ä¸­å¿ƒåº§æ¨™ã§ã€3 ã¤ç›®ãŒç¸ã®åŠå¾„ã€‚
    ã“ã®è¡¨è¨˜ã®å•é¡Œç‚¹ã¯ã€ä¸‰æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã¿ãŸã„ãªã€å®Ÿæ•°ã® 3 ã¤çµ„ã§æŒ‡å®šã§ãã‚‹ä»»æ„ã®ã‚‚ã®ã‚’è¡¨ã›ã¦ã—ã¾ã†ã¨ã„ã†ã“ã¨ã§ã‚ã‚‹ã€‚

    ã‚ˆã‚Šè‰¯ã„è§£æ±ºç­–ã¯ã€å›³å½¢ã‚’è¡¨ã™å‹ã‚’è‡ªä½œã™ã‚‹ã“ã¨ã§ã‚ã‚ã†ã€‚
-}

-------------------------------
-- å½¢ã¥ãã‚‹
-------------------------------

{-
    ã“ã“ã§ã¯ã€é•·æ–¹å½¢ã¨å††ã¨ã„ã† 2 ç¨®é¡ã®å›³å½¢ã‚’æ‰±ã†ã“ã¨ã«ã—ã‚ˆã†ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªã‚„ã‚Šæ–¹ãŒè€ƒãˆã‚‰ã‚Œã‚‹ã€‚
-}

{- ä¸‹éƒ¨ã§å†å®šç¾©ã™ã‚‹ãŸã‚ã€ã“ã“ã§ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ãŠã
data Shape = Circle Float Float Float |
             Rectangle Float Float Float Float
-}

{-
    è§£é‡ˆï¼šCircle å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã¯ã€æµ®å‹•å°æ•°ã‚’å—ã‘å–ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ 3 ã¤ã‚ã‚‹ã€‚
    ã“ã®ã‚ˆã†ã«ã€å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’æ›¸ãã¨ãã¯å¾Œã‚ã«å‹ã‚’ä»˜ã‘è¶³ã™ã“ã¨ãŒã§ãã€ãã‚Œã‚‰ã¯å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ä¸ãˆã‚‹å¼•æ•°ã®å‹ã«ãªã‚‹ã€‚

    ã“ã“ã§ã¯ã€æœ€åˆã® 2 ã¤ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å††ã®ä¸­å¿ƒã®åº§æ¨™ã§ã€3 ã¤ç›®ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å††ã®åŠå¾„ã§ã‚ã‚‹ã€‚
    ä¸€æ–¹ã€Rectangle å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã¯æµ®å‹•å°æ•°ã‚’å—ã‘å–ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ 4 ã¤ã‚ã‚‹ã€‚
    æœ€åˆã® 2 ã¤ã¯å·¦ä¸‹ã®è§’ã€å¾Œã® 2 ã¤ã¯å³ä¸Šã®è§’ã®åº§æ¨™ã‚’è¡¨ã™ã€‚

    å®Ÿã®ã¨ã“ã‚å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã€æœ€çµ‚çš„ã«ãã®ãƒ‡ãƒ¼ã‚¿å‹ã®å€¤ã‚’è¿”ã™é–¢æ•°ãªã®ã§ã‚ã‚‹ã€‚
    ã“ã‚Œã‚‰ 2 ã¤ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å‹ã‚·ã‚°ãƒãƒãƒ£ã‚’è¦‹ã¦ã¿ã‚ˆã†ã€‚

    :t Circle
    > Circle :: Float -> Float -> Float -> Shape

    :t Rectangle
    > Rectangle :: Float -> Float -> Float -> Float -> Shape

    ã¨ã„ã†ã‚ã‘ã§ã€å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ãªã‚“ã®å¤‰å“²ã‚‚ãªã„é–¢æ•°ã§ã‚ã‚‹ã€‚
    ãƒ‡ãƒ¼ã‚¿å‹ã«ã‚ã£ãŸãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã€å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿é–¢æ•°ã«ã¨ã£ã¦ã®å¼•æ•°ã«å¯¾å¿œã™ã‚‹ã€‚

    ã§ã¯ã€Shape ã‚’å¼•æ•°ã«å–ã£ã¦ã€ãã®é¢ç©ã‚’è¿”ã™é–¢æ•°ã‚’ä½œã£ã¦ã¿ã‚ˆã†ã€‚
-}

area :: Shape -> Float
area (Circle _ _ r) = pi * r ^ (2 :: Int)
area (Rectangle x1 y1 x2 y2) = (abs $ x2 - x1) * (abs $ y2 - y1)

{-
    å‹å®£è¨€ã«æ³¨ç›®ã€‚
    area ã¯ã€Shape ã‚’å–ã£ã¦ Float ã‚’è¿”ã™é–¢æ•°ã ã‚ˆã€ã¨è¨€ã£ã¦ã„ã‚‹ã€‚
    ã“ã“ã«ä¾‹ãˆã° Circle -> Float ã¨ã„ã†å‹å®£è¨€ã‚’æ›¸ãã“ã¨ã¯ã§ããªã„ã€‚ãªãœãªã‚‰ Shape ã¯å‹ã ã‘ã© Circle ã¯å‹ã§ãªãå€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚ã‚‹ã‹ã‚‰ã€‚
    ï¼ˆTrue -> Int ã®ã‚ˆã†ãªå‹å®£è¨€ã‚’æŒã¤é–¢æ•°ãŒæ›¸ã‘ãªã„ã®ã¨åŒã˜ï¼‰

    æ¬¡ã«ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã«ä½¿ãˆã‚‹ã“ã¨ã«æ³¨ç›®ã€‚
    ã“ã‚Œã¾ã§ã«ã‚‚ã€[]ã€Falseã€5 ã¨ã„ã£ãŸå€¤ã«å¯¾ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã¯è¡Œã£ã¦ããŸã€‚
    ã—ã‹ã—ã€ä»Šã¾ã§ã®å€¤ã«ã¯ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãªã‹ã£ãŸã€‚ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã‚’è¡Œã„ãŸã„å ´åˆã€
    ã¾ãšå€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿åã‚’æ›¸ãã€ãã‚Œã‹ã‚‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’åå‰ã«æŸç¸›ã™ã‚‹ã€‚
    å††ã®å ´åˆã€å¿…è¦ãªã®ã¯åŠå¾„ã®æƒ…å ±ã ã‘ã§ã€å††ã®ä½ç½®ã‚’è¡¨ã™æœ€åˆã® 2 ã¤ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã„ã‚‰ãªã„ã®ã§ã€_ ã§æ¨ã¦ã¦ã„ã‚‹ã€‚
-}

circleArea :: Float
circleArea = area (Circle 10 20 10) -- ã‚‚ã¡ã‚ã‚“ area $ Circle 10 20 10 ã¨æ›¸ã„ã¦ã‚‚ã‚ˆã„

rectArea :: Float
rectArea = area (Rectangle 0 0 (-100) (-100))

{-
    ã“ã“ã§ã€Circle 10 20 5 ã‚’ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰è¡¨ç¤ºã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚
    ã“ã‚Œã¯ã€Haskell ãŒä»Šä½œã£ãŸãƒ‡ãƒ¼ã‚¿å‹ã‚’æ–‡å­—åˆ—ã«ã—ã¦è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã‚’ã¾ã çŸ¥ã‚‰ãªã„ã‹ã‚‰ã§ã‚ã‚‹ã€‚
    ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰ãªã‚“ã‚‰ã‹ã®å€¤ã‚’è¡¨ç¤ºã—ã‚ˆã†ã¨ã—ãŸå ´åˆã€Haskell ã¯ã¾ãšãã®å€¤ã« show é–¢æ•°ã‚’é©ç”¨ã—ã¦æ–‡å­—åˆ—è¡¨è¨˜ã‚’å¾—ã¦ã€ãã‚Œã‚’ç«¯æœ«ã«è¡¨ç¤ºã™ã‚‹ã€‚

    ã“ã® Shape å‹ã‚’ Show å‹ã‚¯ãƒ©ã‚¹ã®ä¸€å“¡ã«ã™ã‚‹ã«ã¯ã€å‹å®£è¨€ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿®æ­£ã™ã‚‹ã€‚
-}


data Shape = Circle Float Float Float |
             Rectangle Float Float Float Float
    deriving (Show)


{-
    ãƒ‡ãƒ¼ã‚¿å®£è¨€ã®æœ€å¾Œã« deriving (Show) ã¨æ›¸ã‘ã°ã€Haskell ãŒè‡ªå‹•çš„ã«ã“ã®å‹ã‚’ Show å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã—ã¦ãã‚Œã‚‹ã€‚
    ã“ã‚Œã§ Shape å‹ã®å€¤ã‚’è¡¨ç¤ºã§ãã‚‹ã€‚

        Circle 10 20 5
        > Circle 10.0 20.0 5.0

        Rectangle 50 230 60 90
        > Rectangle 50.0 230.0 60.0 90.0

    å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯é–¢æ•°ã§ã‚ã‚‹ã‹ã‚‰ã€æ™®é€šã« map ã—ãŸã‚Šã€éƒ¨åˆ†é©ç”¨ã—ãŸã‚Šã§ãã‚‹ã€‚
    ãŸã¨ãˆã°ã€åŠå¾„ã ã‘é•ã†åŒå¿ƒå††ã®ãƒªã‚¹ãƒˆã‚’ä½œã‚ŠãŸã‹ã£ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã‚‹ã€‚
-}

circles :: [Shape]
circles = map (Circle 10 20) [4, 5, 6, 6] -- [Circle 10.0 20.0 4.0,Circle 10.0 20.0 5.0,Circle 10.0 20.0 6.0,Circle 10.0 20.0 6.0]

--- Â¶ã€€Point ãƒ‡ãƒ¼ã‚¿å‹ã§å½¢ã‚’æ•´ãˆã‚‹
{-
    ã“ã“ã¾ã§ã€ã„ã„æ„Ÿã˜ã«ãƒ‡ãƒ¼ã‚¿å‹ã‚’è‡ªä½œã§ããŸãŒã€ã‚‚ã£ã¨ã‚ˆãã§ãã‚‹ã€‚
    äºŒæ¬¡å…ƒç©ºé–“ã®ç‚¹ã‚’è¡¨ã™ä¸­é–“ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ä½œã‚ã†ã€‚
    ãã†ã™ã‚Œã°å›³å½¢ã‚’ã‚‚ã£ã¨ã‚ã‹ã‚Šã‚„ã™ãã§ãã‚‹ã€‚
-}

data Point = Point Float Float deriving (Show)
data Shape' = Circle' Point Float | Rectangle' Point Point deriving (Show)

{-
    ç‚¹ï¼ˆPointï¼‰ã‚’å®šç¾©ã™ã‚‹ã¨ãã€ãƒ‡ãƒ¼ã‚¿å‹ã¨å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«åŒã˜åå‰ã‚’ä½¿ã£ãŸã€‚ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆã§ã‚ã‚‹ã€‚
    åŒã˜åå‰ã«ã—ã¦ãŠãã“ã¨ã«ç‰¹åˆ¥ãªæ„å‘³ã¯ãªã„ã®ã ãŒã€å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒ 1 ã¤ã—ã‹ãªã„ãƒ‡ãƒ¼ã‚¿å‹ã¯ãã†ã™ã‚‹ã®ãŒæ…£ä¾‹ã€‚
    ã¨ã„ã†ã‚ã‘ã§ã€æ–°ã—ã„ Circle ã«ã¯ 2 ã¤ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹ã€‚
    1 ã¤ã¯Point å‹ã§ã€ã‚‚ã† 1 ã¤ã¯ Float å‹ã€‚ã“ã‚Œã§ã€ã©ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒä½•ãªã®ã‹ã‚ã‹ã‚Šã‚„ã™ããªã£ãŸã€‚
    Rectangle ã‚‚åŒã˜ã“ã¨ã§ã‚ã‚‹ã€‚
    ã§ã¯ã€area é–¢æ•°ã«ã‚‚ã“ã®å¤‰åŒ–ã‚’åæ˜ ã•ã›ã‚ˆã†ã€‚
-}

area' :: Shape' -> Float
area' (Circle' _ r) = pi * r ^ (2 :: Int)
area' (Rectangle' (Point x1 y1) (Point x2 y2)) = (abs $ x2 - x1) * (abs $ y2 - y1)

{-
    å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã£ãŸã®ã¯ãƒ‘ã‚¿ãƒ¼ãƒ³ã ã‘ã§ã‚ã£ãŸã€‚Circle ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€ç‚¹å…¨ä½“ã‚’ç„¡è¦–ã—ã¦ã„ã‚‹ã€‚
    Rectangle ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã‚’ãƒã‚¹ãƒˆã™ã‚‹ã“ã¨ã§ã€ä¸€æ°—ã«ç‚¹ãŒå±ã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¸ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ã€‚
    æ”¹è‰¯ã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è©¦ã—ã¦ã¿ã‚ˆã†ã€‚
-}

rectArea' :: Float
rectArea' = area' (Rectangle' (Point 0 0) (Point 100 100)) -- 10000.0

circleArea' :: Float
circleArea' = area' (Circle' (Point 0 0) 24) -- 1809.5574

{-
å›³å½¢ã‚’å‹•ã‹ã™é–¢æ•°ã‚‚å®šç¾©ã—ã¦ã¿ã‚‹ã€‚
å›³å½¢ã¨ã€x è»¸æ–¹å‘ã¸ã®ç§»å‹•é‡ã€y è»¸æ–¹å‘ã¸ã®ç§»å‹•é‡ã‚’å–ã£ã¦ã€å…ƒã®å›³å½¢ã¨åŒã˜å¯¸æ³•ã ã‘ã©é•ã†å ´æ‰€ã«ã‚ã‚‹å›³å½¢ã‚’è¿”ã™ã€‚
-}

nudge :: Shape' -> Float -> Float -> Shape'
nudge (Circle' (Point x1 y1) r ) dx dy = Circle' (Point (x1+dx) (y1+dy)) r
nudge (Rectangle' (Point x1 y1) (Point x2 y2)) dx dy = Rectangle' (Point (x1+dx) (y1+dy)) (Point (x2+dx) (y2+dy))

-- ä½¿ç”¨ä¾‹
nudgedCircle :: Shape'
nudgedCircle = nudge (Circle' (Point 0 0) 12) 5 10 -- Circle' (Point 5.0 10.0) 12.0

{- ã‚‚ã—ç‚¹ã‚’ç›´æ¥è§¦ã‚ŠãŸããªã„ã¨ã„ã†å ´åˆã«ã¯ã€æŒ‡å®šã—ãŸã‚µã‚¤ã‚ºã®å›³å½¢ã‚’åŸç‚¹ã«ä½œã‚‹è£œåŠ©é–¢æ•°ã‚’ä½œã£ã¦ã€ãã‚Œã‹ã‚‰ç§»å‹•ã•ã›ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ã€€-}

baseCircle :: Float -> Shape'
baseCircle r = Circle' (Point 0 0) r

baseRect :: Float -> Float -> Shape'
baseRect width height = Rectangle' (Point 0 0) (Point width height)

{- ã“ã‚Œã‚‰ã®é–¢æ•°ã‚’ä½¿ãˆã°ã€ã¾ãšåº§æ¨™ç³»ã®åŸç‚¹ã«å›³å½¢ã‚’ä½œã£ã¦ã€ãã‚Œã‹ã‚‰æœ›ã¿ã®å ´æ‰€ã¾ã§ç§»å‹•ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã“ã‚Œã§å›³å½¢ã‚’ä½œã‚‹ã®ãŒæ¥½ã«ãªã‚‹ã€‚-}

myRect :: Shape'
myRect = nudge (baseRect 40 100) 60 23 -- Rectangle' (Point 60.0 23.0) (Point 100.0 123.0)

--- Â¶ã€€Shape ã‚’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹
{-
    è‡ªä½œã®ãƒ‡ãƒ¼ã‚¿å‹ã‚‚è‡ªä½œã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§ãã‚‹ã€‚å‹ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã«ã¯ã€é–¢æ•°ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã¨åŒã˜ã¨ã“ã‚ã«å‹åã‚’æ›¸ãã ã‘ã§ã‚ã‚‹ã€‚
    å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸã„å ´åˆã¯ã€å‹åã®å¾Œã«æ‹¬å¼§ã‚’è¿½åŠ ã—ã€ãã®ä¸­ã«ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’æ›¸ãã€‚
    ã‚ã‚‹å‹ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ã™ã¹ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸã„å ´åˆã¯ã€ãƒ”ãƒªã‚ªãƒ‰ 2 ã¤ï¼ˆ..ï¼‰ã‚’æ›¸ãã€‚
    å›³å½¢ã‚’æ‰±ã†é–¢æ•°ã¨å‹ã‚’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸã„ã¨ã—ãŸã‚‰ã€ã“ã†æ›¸ãå§‹ã‚ã‚‹ã€‚

        module Shapes
        ( Point (..)
        , Shape (..)
        , area
        , nudge
        , baseCircle
        , baseRect
        ) where

    Shape (..) ã¨æ›¸ãã“ã¨ã§ã€Shape ã®ã™ã¹ã¦ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã€‚
    ã¤ã¾ã‚Šã€ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸäººã¯ã€Rectangle ã¨ Circle ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ä½¿ã£ã¦å›³å½¢ã‚’ä½œã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚

    ã“ã®è¡Œã¯ã€€Shape (Rectangle, Circle) ã¨æ›¸ã„ã¦ã‚‚åŒã˜ã“ã¨ã ãŒã€(..) ã‚’ä½¿ã†ã»ã†ãŒç°¡å˜ã€‚
    ãã‚Œã«ã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸå‹ã«å¾Œã‹ã‚‰å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã«ã—ãŸå ´åˆã§ã‚‚ã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ–‡ã‚’å¤‰ãˆã‚‹å¿…è¦ãŒãªããªã‚‹ã€‚
    .. ã‚’ä½¿ãˆã°ã€ãã®å‹ã®ã™ã¹ã¦ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒè‡ªå‹•çš„ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‹ã‚‰ã§ã‚ã‚‹ã€‚

    ä¸€æ–¹ã€Shape ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ–‡ã®å¾Œã«æ‹¬å¼§ã‚’ä»˜ã‘ãªã„ã“ã¨ã§ã€Shape å‹ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã‘ã‚Œã©ã‚‚ãã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ä¸€åˆ‡ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãªã„ã€ã¨ã„ã†é¸æŠã‚‚ã§ãã‚‹ã€‚
    ã™ã‚‹ã¨ã€ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ã¯è£œåŠ©é–¢æ•° baseCircle ã¨ baseRect çµŒç”±ã§ã—ã‹å›³å½¢ã‚’ä½œã‚Œãªããªã‚‹ã€‚

    ä»¥ä¸‹ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ Shapes.hs ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã§ä¿å­˜ã—ãŸã†ãˆã§ã€

        ```
        module Shapes
        (Point, Shape, area, nudge, baseCircle, baseRect) where

        data Point = Point Float Float deriving (Show)
        data Shape =    Circle Point Float | 
                        Rectangle Point Point deriving (Show)

        area :: Shape -> Float
        area (Circle _ r) = pi * r ^ 2
        area (Rectangle (Point x1 y1) (Point x2 y2)) = (abs $ x2 - x1) * (abs $ y2 - y1)

        nudge :: Shape -> Float -> Float -> Shape
        nudge (Circle (Point x y) r) dx dy = Circle (Point (x+dx) (y+dy)) r
        nudge (Rectangle (Point x1 y1) (Point x2 y2)) dx dy = Rectangle (Point (x1+dx) (y1+dy)) (Point (x2+dx) (y2+dy))

        baseCircle :: Float -> Shape
        baseCircle r = Circle (Point 0 0) r

        baseRect :: Float -> Float -> Shape
        baseRect width height = Rectangle (Point 0 0) (Point width height)
        ```

    ä»¥ä¸‹ã®ã‚ˆã†ãª Main.hs ã‚’ä½œã£ã¦å‹•ã‹ã—ã¦ã¿ã‚ˆã†ã€‚

        ```
        import Shapes

        main = do
            print $ Circle (Point 10 20) 30
        ```

    ã“ã†ã™ã‚‹ã¨ã€Circle ã‚‚ Point ã‚‚çŸ¥ã‚Šã¾ã›ã‚“ã‚ˆã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã€‚
    ã“ã®ã‚ˆã†ã«ã—ã¦ã€Haskell ã¯ Shapes ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’å®Œç’§ã«å®ˆã‚‹ã®ã§ã‚ã‚‹
    ï¼ˆã¡ãªã¿ã«ã€ã“ã“ã® Point ã¯ Shapes ã‹ã‚‰ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹å‹ã¨ã—ã¦ã® Point ã§ã¯ãªãã€å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨ã—ã¦ã® Pointï¼‰ã€‚

    ä¸€æ–¹ã€Main.hs ã‚’æ¬¡ã®ã‚ˆã†ã«æ›¸ãç›´ã›ã°ã€Shapes ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒè¨±å¯ã—ã¦ã„ã‚‹ã‚‚ã®ã—ã‹ä½¿ã£ã¦ã„ãªã„ãŸã‚ã€æ­£ã—ãå‹•ãã€‚

        ```
        import Shapes
        main = do
            print $ nudge (baseCircle 30) 10 20
        ```

    å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å¼•æ•°ã«å–ã£ã¦ãƒ‡ãƒ¼ã‚¿å‹ï¼ˆãŸã¨ãˆã° Shape å‹ï¼‰ã®å€¤ã‚’è¿”ã™é–¢æ•°ã«éããªã„ã®ã ã£ãŸã€‚
    å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãªã„ã€ã¨ã„ã†é¸æŠã‚’ã™ã‚Œã°ã€ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹äººãŒå€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’é–¢æ•°ã¨ã—ã¦ç›´æ¥ä½¿ã†ã“ã¨ã‚’é˜²ãã“ã¨ã«ãªã‚‹ã€‚
    ãƒ‡ãƒ¼ã‚¿å‹ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãªã„ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿å‹ã®å®Ÿè£…ã‚’éš ã—ã€ãƒ‡ãƒ¼ã‚¿å‹ã®æŠ½è±¡åº¦ã‚’ä¸Šã’ã‚‰ã‚Œã‚‹ã€‚
    ã¾ãŸã€å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ä½¿ã£ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã‚‚ã§ããªããªã‚‹ã€‚
    ãƒ¦ãƒ¼ã‚¶ã«ã¯å¿…ãšãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æä¾›ã™ã‚‹è£œåŠ©é–¢æ•°ï¼ˆä»Šå›ã®ä¾‹ã§ã¯ baseCircle ã‚„ baseRectï¼‰ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿å‹ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã»ã—ã„ã€ã¨ã„ã†å ´åˆã«ã¯ã€
    å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãªã„ã“ã¨ãŒæœ›ã¾ã—ã„é¸æŠã«ãªã‚‹ã€‚
    ãã†ã™ã‚Œã°ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…éƒ¨ã®è©³ç´°ã‚’çŸ¥ã‚‹å¿…è¦ãŒãªããªã‚‹ã†ãˆã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä½œè€…ã«ã¨ã£ã¦ã‚‚ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸé–¢æ•°ã®æŒ¯ã‚‹èˆã„ãŒåŒã˜ã§ã‚ã‚‹ã‹ãã‚Šå†…éƒ¨ã®å®Ÿè£…ã‚’è‡ªç”±ã«å¤‰ãˆã‚‰ã‚Œã‚‹ã¨ã„ã†åˆ©ç‚¹ãŒã‚ã‚‹ã€‚
    ï¼ˆã“ã®ã‚ˆã†ã«ã€ãƒ¦ãƒ¼ã‚¶ã«å¿…è¦ãªã ã‘ã®æ“ä½œæ³•ã‚’æä¾›ã™ã‚‹ãŒã€å®Ÿè£…ã®è©³ç´°ã¯éš ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿å‹ã®ã“ã¨ã‚’æŠ½è±¡ãƒ‡ãƒ¼ã‚¿å‹ã¨å‘¼ã¶ï¼‰

    Data.Map ã¯ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å–ã£ã¦ã„ã‚‹ã€‚å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‹ã‚‰ç›´æ¥ Map ã‚’ä½œã‚‹ã“ã¨ã¯ã§ããªã„ï¼ˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ã‹ã‚‰ï¼‰ã€‚
    ã ãŒã€Map.fromList ã®ã‚ˆã†ãªè£œåŠ©é–¢æ•°ã‚’ä½¿ã£ã¦ Map ã‚’ä½œã‚‹ã“ã¨ã¯æ™®é€šã«ã§ãã‚‹ã€‚
    ãŠã‹ã’ã§ Data.Map ã®ä½œè€…ãŸã¡ã¯ã€æ—¢å­˜ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å£Šã™å¿ƒé…ãªãã€è‡ªç”±ã« Map ã®å†…éƒ¨è¡¨ç¾ã‚’å¤‰æ›´ã§ãã‚‹ã®ã§ã‚ã‚‹ã€‚

    ãŸã ã€å˜ç´”ãªãƒ‡ãƒ¼ã‚¿å‹ã«å¯¾ã—ã¦ã¯ã€å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ã®ã‚‚ãªã‚“ã‚‰å•é¡Œãªã„æ–¹é‡ã§ã‚ã‚‹ã€‚
-}

-------------------------------
-- ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡
-------------------------------

{-
    ä»Šåº¦ã¯ãƒ‡ãƒ¼ã‚¿å‹ã‚’ä½œã‚‹åˆ¥ã®æ–¹æ³•ã‚’è¦‹ã¦ã„ã“ã†ã€‚
    äººç‰©ã‚’è¨˜è¿°ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã‚’ä½œã‚‹ä»•äº‹ã‚’ä»»ã•ã‚ŒãŸã¨ã™ã‚‹ã€‚
    äººç‰©ã«é–¢ã—ã¦ã¯ã€ãã®åå‰ã€è‹—å­—ã€å¹´é½¢ã€èº«é•·ã€é›»è©±ç•ªå·ã€å¥½ããªã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ ã®å‘³ã‚’è¨˜éŒ²ã™ã‚‹ã“ã¨ã«ã™ã‚‹ã€‚
    ã•ã£ããã‚„ã£ã¦ã¿ã‚ˆã†ã€‚
-}

--data Person = Person String String Int Float String String
--    deriving (Show)

{- ã§ã¯äººç‰©ã‚’ä½œã£ã¦ã¿ã‚ˆã† -}

--guy :: Person
--guy = Person "Buddy" "Finklestein" 43 184.2 "526-2928" "Chocolate"

-- guy
-- > Person "Buddy" "Finklestein" 43 184.2 "526-2928" "Chocolate"

{-
    ç‰¹å®šã®æƒ…å ±ã‚’å–ã‚Šå‡ºã™ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã ã‚ã†ï¼Ÿ
    äººç‰©ã®åå‰ã‚’å–ã‚Šå‡ºã™é–¢æ•°ã¨ã‹ã€è‹—å­—ã‚’å–ã‚Šå‡ºã™é–¢æ•°ã¨ã‹ãŒå¿…è¦ã€‚
-}

{-
firstName :: Person -> String
firstName (Person firstname _ _ _ _ _) = firstname

lastName :: Person -> String
lastName (Person _ lastname _ _ _ _) = lastname

age :: Person -> Int
age (Person _ _ age' _ _ _) = age'

tall :: Person -> Float
tall (Person _ _ _ height' _ _) = height'

phoneNumber :: Person -> String
phoneNumber (Person _ _ _ _ number' _) = number'

flavor :: Person -> String
flavor (Person _ _ _ _ _ flavor') = flavor'
-}

{-
    ã“ã‚“ãªã‚³ãƒ¼ãƒ‰ã€æ›¸ã„ã¦ã„ã¦ã‚‚æ¥½ã—ããªã„ï¼ãŒã€ã“ã®æ–¹æ³•ã§å‹•ãã“ã¨ã¯å‹•ãã€‚

        firstName guy
        > "Buddy"

    ã ãŒã€Haskell ã«ã¯ã‚‚ã† 1 ã¤ã€ãƒ‡ãƒ¼ã‚¿å‹ã‚’æ›¸ããŸã‚ã®æ§‹æ–‡ãŒå‚™ã‚ã£ã¦ã„ã‚‹ã€‚
    ãã‚Œã¯**ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡**ã§ã‚ã‚‹ã€‚
-}

data Person = Person {  firstName :: String
                    ,   lastName :: String
                    ,   age :: Int
                    ,   tall :: Float
                    ,   phoneNumber :: String
                    ,   flavor :: String } deriving (Show)

{-
    ã“ã®ã‚ˆã†ã«ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã§ã¯ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹åã ã‘ã‚’ã‚¹ãƒšãƒ¼ã‚¹åŒºåˆ‡ã‚Šã§åˆ—æŒ™ã™ã‚‹ä»£ã‚ã‚Šã«ã€ä¸­æ‹¬å¼§ã‚’ä½¿ã†ã€‚
    ã¾ãšãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®åå‰ï¼ˆä¾‹ãˆã° firstNameï¼‰ã‚’æ›¸ãã€æ¬¡ã« :: ã‚’æ›¸ãã€ãã‚Œã‹ã‚‰å‹ã‚’æ›¸ãã€‚
    å‡ºæ¥ä¸ŠãŒã£ãŸãƒ‡ãƒ¼ã‚¿å‹ã¯ä»¥å‰ã®ã‚‚ã®ã¨ã¾ã£ãŸãåŒã˜ã€‚
    ã“ã®å¹¸é‹ã®åˆ©ç‚¹ã¯ã€ãƒ‡ãƒ¼ã‚¿å‹ã¨åŒæ™‚ã«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å–å¾—ã™ã‚‹é–¢æ•°ãŸã¡ãŒä½œã‚‰ã‚Œã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚
    ã“ã®å‹ã‚’ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã‚’ä½¿ã£ã¦å®šç¾©ã—ãŸkã¨ã§ã€Haskell ã¯ firstNameã€lastNameã€ageã€heightã€phoneNumberã€flavor ã¨ã„ã†
    6 ã¤ã®é–¢æ•°ã‚’è‡ªå‹•çš„ã«ä½œã£ã¦ãã‚Œã‚‹ã®ã§ã‚ã‚‹ã€‚

    ãŸã¨ãˆã°ã“ã“ã§ :t flavor ã¨ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«å‡ºåŠ›ã•ã‚Œã‚‹ã€‚
        flavor :: Person -> String

    ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã«ã¯ã‚‚ã† 1 ã¤åˆ©ç‚¹ãŒã‚ã‚‹ã€‚
    Show ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è‡ªå‹•å°å‡ºï¼ˆderiveï¼‰ã™ã‚‹ã¨ãã€ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã‚’ä½¿ã£ã¦å®šç¾©ã—ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãŸå‹ã¯ã€ãã†ã§ãªã„å‹ã¨ã¯é•ã†è¡¨ç¤ºã®ä»•æ–¹ã«ãªã‚‹ã€‚
    ä¾‹ãˆã°è‡ªå‹•è»Šã‚’è¡¨ã™å‹ãŒã‚ã‚‹ã¨ã—ã‚ˆã†ã€‚ãƒ¡ãƒ¼ã‚«ãƒ¼ã€ãƒ¢ãƒ‡ãƒ«åã€ç”Ÿç”£ã•ã‚ŒãŸå¹´ã‚’è¨˜éŒ²ã—ãŸã„ã¨ã™ã‚‹ã€‚ã“ã®å‹ã¯ã€ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã‚’ä½¿ã‚ãªã„å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã§ãã‚‹ã€‚
-}

data Car' = Car' String String Int deriving (Show)

{-
    è‡ªå‹•è»Šã¯ã€ä¾‹ãˆã°ã“ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€‚
        Car' "Ford" "Mustang" 1967
        > Car' "Ford" "Mustang" 1967
-}

{-
    ã§ã¯ã€ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã‚’ä½¿ã£ã¦å®šç¾©ã—ãŸå ´åˆã¯ä½•ãŒèµ·ã“ã‚‹ã®ã ã‚ã†ã‹ï¼Ÿ
-}

data Car = Car {    company :: String
                ,   model :: String
                ,   year :: Int
                } deriving (Show)

myCar :: Car
myCar = Car {company="Toyota", model="Prius", year=2020}

{-
    ä»Šåº¦ã¯ã“ã®ã‚ˆã†ã«ã—ã¦è‡ªå‹•è»ŠãŒä½œã‚Œã‚‹ã€‚
        Car {company="Ford", model="Mustang", year=1967}
        > Car {company = "Ford", model = "Mustang", year = 1967}

    > ğŸ’¡  ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã¯ã€ã™ã§ã«å®šç¾©æ¸ˆã¿ã®å€¤ã‚’ã‚‚ã¨ã«ã€ä¸€éƒ¨ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã ã‘ãŒç•°ãªã‚‹å€¤ã‚’ä½œã‚‹ã®ã«ã‚‚ä½¿ãˆã‚‹ã€‚
    >     myCar ãŒ Car å‹ã®å€¤ã§ã‚ã‚‹ã¨ãã«ã€myCar{year=2013} ã¯ã€myCar ã¨åŒã˜ä¼šç¤¾ã®åŒã˜ãƒ¢ãƒ‡ãƒ«åã®ã€2013 å¹´ç‰ˆã‚’è¡¨ã™ã€‚

    ã“ã®ã¨ããƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å…ƒã©ãŠã‚Šã®é †ç•ªã§æŒ‡å®šã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ãŸã ã—ã€ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’åŸ‹ã‚ã‚‹å¿…è¦ã¯ã‚ã‚‹ã€‚
    ä¸€æ–¹ã€ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã‚’ä½¿ã‚ãªã„å ´åˆã¯ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é †ç•ªã©ãŠã‚Šã«æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

    å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«è¤‡æ•°ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Šã€ã©ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒä½•ç•ªç›®ãªã®ã‹ç´›ã‚‰ã‚ã—ã„å ´åˆã¯ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã‚’ä½¿ã†ã“ã¨ã€‚
    ä¸‰æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ `data Vector = Vector Int Int Int` ã¨ã—ã¦ä½œã£ãŸå ´åˆã¯ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãƒ™ã‚¯ãƒˆãƒ«ã®æˆåˆ†ã§ã‚ã‚‹ã“ã¨ã¯æ˜ã‚‰ã‹ã§ã‚ã‚‹ã€‚
    ä¸€æ–¹ã€Person ã‚„ Car ã®ä¾‹ã§ã¯ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒä½•ã‚’æŒ‡ã™ã®ã‹è‡ªæ˜ã§ã¯ãªã„ã®ã§ã€ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã‚’ä½¿ã†ã»ã†ãŒä¾¿åˆ©ã§ã‚ã‚‹ã€‚
-}

-------------------------------
-- å‹å¼•æ•°
-------------------------------

{-
    å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯å¼•æ•°ã‚’å–ã£ã¦æ–°ã—ã„å€¤ã‚’ç”Ÿã¿å‡ºã™ã®ã ã£ãŸã€‚
    ãŸã¨ãˆã°ã€Car ã¨ã„ã†å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ 3 ã¤ã®å€¤ã‚’å—ã‘å–ã£ã¦è‡ªå‹•è»Šã‚’è¡¨ã™å€¤ã‚’ä½œã‚‹ã€‚
    åŒæ§˜ã«ã€_å‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯å‹ã‚’å¼•æ•°ã«å–ã£ã¦æ–°ã—ã„å‹ã‚’ä½œã‚‹_ã‚‚ã®ã€‚

    å‹å¼•æ•°ãŒã©ã†ä½¿ã‚ã‚Œã‚‹ã‹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ´ã‚€ãŸã‚ã«ã€ã™ã§ã«çŸ¥ã£ã¦ã„ã‚‹å‹ãŒã©ã‚“ãªå®Ÿè£…ã«ãªã£ã¦ã„ã‚‹ã‹è¦‹ã¦ã¿ã‚ˆã†ã€‚

        data Maybe a = Nothing | Just a

    ã“ã® a ãŒå‹å¼•æ•°ã§ã‚ã‚‹ï¼ˆc.f. someFunc :: [a] -> a ã®ã‚ˆã†ã«ã€å‹å®šç¾©ã®ä¸­ã§ä½¿ã† a ã®ã‚ˆã†ãªã‚‚ã®ã¯ã€Œå‹å¤‰æ•°ã€ã¨å‘¼ã¶ã®ã ã£ãŸï¼‰ã€‚
    ãã—ã¦å‹å¼•æ•°ã‚’å–ã£ã¦ã„ã‚‹ã®ã§ã€Maybe ã¯å‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨å‘¼ã°ã‚Œã‚‹ã€‚
    Nothing ã§ãªã„å ´åˆã«ä½•ã‚’ã“ã®ãƒ‡ãƒ¼ã‚¿å‹ã«ä¿æŒã•ã›ãŸã„ã‹ã«å¿œã˜ã¦ã€ã“ã®å‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‹ã‚‰ Maybe Intã€Maybe Carã€Maybe String ãªã©ã®å‹ã‚’ä½œã‚Œã‚‹ã€‚
    å˜ãªã‚‹ Maybe ã¨ã„ã†å‹ã®å€¤ã¯å­˜åœ¨ã§ããªã„ã€‚
    ãªãœãªã‚‰ã€Maybe ã¯å‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚ã£ã¦ã€å‹ã§ã¯ãªã„ã‹ã‚‰ã§ã‚ã‚‹ã€‚
    å‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ã€_ã™ã¹ã¦ã®å¼•æ•°ã‚’åŸ‹ã‚ã¦åˆã‚ã¦ä½•ã‹ã—ã‚‰ã®å€¤ã®å‹ã«ãªã‚Œã‚‹_ã€‚

    Char ã‚’ Maybe ã®å‹å¼•æ•°ã«æ¸¡ã™ã¨ Maybe Char ã¨ã„ã†å‹ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚ãŸã¨ãˆã° Just 'a' ã¨ã„ã†å€¤ã¯ Maybe Char ã¨ã„ã†å‹ã‚’æŒã¤ã€‚
    ã»ã¨ã‚“ã©ã®å ´åˆã€å‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«å‹å¼•æ•°ã‚’æ¸¡ã—ã¦ä½œã£ãŸå‹ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹å¿…è¦ã¯ãªã„ã€‚Haskell ã«ã¯å‹æ¨è«–ãŒã‚ã‚‹ã‹ã‚‰ã§ã‚ã‚‹ã€‚

    ãŸã¨ãˆã° Just 'a' ã¨ã„ã†å€¤ã‚’ä½œã‚‹ã¨ã€Haskell ã¯ãã®å‹ãŒ Maybe Char ã ã¨æ¨è«–ã—ã¦ãã‚Œã‚‹ã€‚

    æ˜ç¤ºçš„ã«å‹ã‚’å‹å¼•æ•°ã¨ã—ã¦æ¸¡ã—ãŸã‘ã‚Œã°ã€å‹ã®ä¸–ç•Œã§è¡Œã†å¿…è¦ãŒã‚ã‚‹ã€‚
    Haskell ã§ã¯ã€:: è¨˜å·ã®å³å´ãŒå‹ã®ä¸–ç•Œã€‚
    ã“ã®æ‰‹æ³•ã¯ã€ä¾‹ãˆã° Just 3 ã« Maybe Int ã¨ã„ã†å‹ã‚’æŒã£ã¦æ¬²ã—ã„å ´åˆã«ä¾¿åˆ©ã§ã‚ã‚‹ã€‚
    ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Haskell ã¯ã“ã®å€¤ã®å‹ã‚’ Just 3 :: Num a => Maybe a ã¨æ¨è«–ã™ã‚‹ãŒã€æ˜ç¤ºçš„ãªç‰‡æ³¨é‡ˆã‚’ä½¿ãˆã°ã€å‹ã®åˆ¶é™ã‚’å°‘ã—ã‚­ãƒ„ãã§ãã‚‹ã€‚

        Just 3 :: Maybe Int
        > Just 3

    å®Ÿã¯ã€Maybe ã‚’ä½¿ã†ã‚ˆã‚Šå‰ã«å‹å¼•æ•°ã‚’ä½¿ã£ã¦ã„ãŸã€‚ãã‚Œã¯ãƒªã‚¹ãƒˆå‹ã§ã‚ã‚‹ã€‚æ§‹æ–‡ç³–è¡£ãŒã‚ã‚‹ãŸã‚ã‚ã‹ã‚Šã«ãã„ãŒã€ãƒªã‚¹ãƒˆå‹ã¯ 1 ã¤ã®å‹å¼•æ•°ã‚’å–ã£ã¦å…·ä½“å‹ã‚’ç”Ÿæˆã™ã‚‹ã®ã§ã‚ã‚‹ã€‚
    [Int] å‹ã®å€¤ã€[Char] å‹ã®å€¤ã€[[String]] å‹ã®å€¤ã€ãªã©ã¯ã‚ã‚‹ãŒã€[] å‹ã®å€¤ã¨ã„ã†ã®ã¯ä½œã‚Œãªã„ã€‚
        ğŸ’¡  å…·ä½“å‹ã¨ã¯ã€å‹å¼•æ•°ã‚’ 1 ã¤ã‚‚å–ã‚‰ãªã„å‹ã‹ã€ã‚ã‚‹ã„ã¯ã€å‹å¼•æ•°ã‚’å–ã‚‹ã‘ã‚Œã©ã‚‚ãã‚ŒãŒã™ã¹ã¦åŸ‹ã¾ã£ã¦ã„ã‚‹å‹ã®ã“ã¨ã‚’æŒ‡ã™ã€‚
            å‰è€…ã®ä¾‹ã¯ Int ã‚„ Boolã€å¾Œè€…ã®ä¾‹ã¯ Maybe Char ã§ã‚ã‚‹ã€‚ãªã‚“ã‚‰ã‹ã®å€¤ãŒã‚ã£ãŸã‚‰ã€ãã®å‹ã¯ã¤ã­ã«å…·ä½“å‹ã§ã‚ã‚‹ã€‚

    Maybe å‹ã§éŠã‚“ã§ã¿ã‚ˆã†ã€‚
-}

--- ä»¥ä¸‹ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«è¨˜è¿°ã™ã‚‹ãŸã‚ã«å‹å®£è¨€ã‚‚æ›¸ã„ã¦ã—ã¾ã£ã¦ã„ã‚‹ãŒã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä½¿ãˆã° Just "Haha" ãªã©ã¨æ‰“ã¡è¾¼ã‚€ã ã‘ã§ã‚ˆãã€
--- :t Just "Haha" ã¨ã™ã‚‹ã¨ :: Maybe [Char] ãªã©ã¨å‡ºåŠ›ã•ã‚Œã‚‹ã®ã§ã€Haskell ãŒå‹æ¨è«–ã—ã¦ãã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚
haha :: Maybe String
haha = Just "Haha"

eightyFour :: Maybe Int
eightyFour = Just 84

{-
ä»–ï¼‰
    :t Nothing
    > Nothing :: Maybe a

    Just 10 :: Maybe Double
    > Just 10.0
-}

{-
    å‹å¼•æ•°ãŒä¾¿åˆ©ãªã®ã¯ã€ã•ã¾ã–ã¾ãªå‹ã‚’åç´ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã‚’ä½œã‚Œã‚‹ã¨ã“ã‚ã§ã‚ã‚‹ã€‚
    ãŸã¨ãˆã° Maybe ã‚’å®šç¾©ã™ã‚‹ã®ã«ã€ä¸­èº«ã®å‹ã”ã¨ã«åˆ¥ã€…ã®å‹ã«ã™ã‚‹ã“ã¨ã‚‚ã§ããªãã¯ãªã„ã€‚
-}

data IntMaybe = INothing | IJust Int
data StringMaybe = SNothing | SJust String
data ShapeMaybe = ShNothing | ShJust Shape

{- ã§ã‚‚ã€å‹å¼•æ•°ã‚’ä½¿ã£ã¦ã©ã‚“ãªå‹ã®å€¤ã§ã‚‚åç´ã§ãã‚‹æ±ç”¨ã® Maybe ã‚’ä½œã£ãŸã»ã†ãŒä¾¿åˆ©ã€€-}
data Maybe' a = MyNothing | MyJust a

{-
Nothing ã®å‹ãŒ Maybe a ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã€‚ã“ã®å‹ã¯å‹å¼•æ•°ãŒã‚ã‚‹ï¼ˆã¤ã¾ã‚Š Maybe a ã® a ãŒã‚ã‚‹ï¼‰ã®ã§ **å¤šç›¸çš„** ã§ã‚ã‚‹ã€‚
ã‚‚ã—ã€Maybe Int ã‚’å¼•æ•°ã«å–ã‚‹é–¢æ•°ãŒã‚ã‚Œã°ã€ãã‚Œã« Nothing ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã‚‹ã€‚
Nothing ã¯å€¤ã‚’å«ã‚“ã§ã„ãªã„ã®ã§ã€ã©ã®ã¿ã¡å•é¡Œãªã„ã®ã§ã‚ã‚‹ã€‚

ã“ã®ã‚ˆã†ã«ã€Maybe a å‹ã®å€¤ã¯ã€Maybe Int å‹ãŒè¦æ±‚ã•ã‚Œã‚‹å ´æ‰€ã§ã‚‚ä½¿ãˆã‚‹ã€‚
ã¡ã‚‡ã†ã©ã€5 ã¯ Int ã¨ã—ã¦ã‚‚ Double ã¨ã—ã¦ã‚‚ä½¿ãˆã‚‹ã®ã¨åŒã˜ã“ã¨ã§ã‚ã‚‹ã€‚
ï¼ˆç¾ã«ã€:t 5 ã¨ã™ã‚‹ã¨ Int ã¨ã‹ãã†ã„ã†ç¢ºå®šçš„ãªå‹ãŒå‡ºåŠ›ã•ã‚Œã‚‹ã®ã§ã¯ãªãã€`5 :: Num p => p` ã¨ã„ã†ãµã†ã«ã€å‹å¤‰æ•°ã‚’ä½¿ã£ãŸè¡¨ç¤ºãŒã•ã‚Œã‚‹ï¼‰

åŒæ§˜ã«ã€ç©ºãƒªã‚¹ãƒˆã®å‹ã¯ [a] ã§ã‚ã‚‹ã€‚
ã“ã‚ŒãŒã€ [1, 2, 3] ++ [] ã¨ã„ã†ä½¿ã„æ–¹ã‚‚ ["ha", "ha", "ha"] ++ [] ã¨ã„ã†ä½¿ã„æ–¹ã‚‚åŒæ™‚ã«ã§ãã‚‹ç†ç”±ã§ã‚ã‚‹ã€‚
-}

nothingInMaybeInt :: Maybe Int
nothingInMaybeInt = Nothing

--- Â¶ã€€è‡ªå‹•è»Šã¯å‹å¼•æ•°ã‚’å–ã‚‹ã¹ãã‹ï¼Ÿ
{-
    å‹å¼•æ•°ã‚’ä½¿ã†ã®ãŒã‚ˆã„ã®ã¯ã©ã†ã„ã†ã¨ãã ã‚ã†ã‹ï¼Ÿ
    æ™®é€šã€å‹å¼•æ•°ã¯ Maybe a å‹ã®ã‚ˆã†ãªã€ã©ã‚“ãªå‹ã‚’ãã“ã«æŒã£ã¦ãã¦ã‚‚å¤‰ã‚ã‚‰ãšå‹•ä½œã™ã‚‹ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿å‹ã«ä½¿ã†ã‚‚ã®ã§ã‚ã‚‹ã€‚
    ã‚ã‚‹å‹ãŒãªã‚“ã‚‰ã‹ã®ç®±ã®ã‚ˆã†ã«æŒ¯èˆã†ãªã‚‰ã€å‹å¼•æ•°ã‚’ä½¿ã†ã¨ã‚ˆã„ã ã‚ã†ã€‚

    Car ãƒ‡ãƒ¼ã‚¿å‹ã‚’ä¸Šè¨˜ã§ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ãŸã®ã ã£ãŸã€‚
        data Car = Car {    company :: String
                        ,   model :: String
                        ,   year :: Int
                        } deriving (Show)

    ã“ã‚Œã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¦ã¿ã‚‹ã€‚
-}
data Kuruma a b c = Kuruma {  company' :: a
                            , model'  :: b
                            , year' :: c } deriving (Show)

{-
    ã•ã¦ã€ã“ã‚Œã«ãƒ¡ãƒªãƒƒãƒˆã¯ãƒ»ãƒ»ãƒ»ï¼Ÿã€€ãŠãã‚‰ãçš†ç„¡ã€‚
    ã©ã†ã› Kuruma String String Int ã‚’æ‰±ã†é–¢æ•°ã—ã‹ä½œã‚‰ãªã„ã ã‚ã†ã‹ã‚‰ã€‚
    ä¾‹ãˆã°ã€ä¸Šã§å®šç¾©ã—ãŸï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹æ–‡ã®ï¼‰Car ã‚’ä½¿ãˆã°ã€è‡ªå‹•è»Šã®æƒ…å ±ã‚’èª­ã¿ã‚„ã™ã„å½¢ã§è¡¨ç¤ºã™ã‚‹é–¢æ•°ã¯æ¬¡ã®ã‚ˆã†ã«æ›¸ã‘ã‚‹ã€‚
-}

tellCar :: Car -> String
tellCar (Car {company = c, model = m, year = y})
    = "This " ++ c ++ " " ++ m ++ " was made in " ++ show y
    -- ã“ã‚Œã§ tellCar myCar ã¨ã™ã‚‹ã¨ã€"This Toyota Prius was made in 2020" ã¨ã„ã†å‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚

{-
    ã§ã¯ã€Car ãŒ Car a b c ã ã£ãŸã‚‰ã©ã†ãªã‚‹ã‹ï¼Ÿ
        tellCar :: (Show a) => Car String String a -> String
        telLCar (Car {company = c, model = m, year = y}) = "This " ++ c ++ " " ++ m ++ " was made in " ++ show y

    ã¨ãªã£ã¦ã€å‹ã‚·ã‚°ãƒãƒãƒ£ãŒè¤‡é›‘ã«ãªã‚‹ã€‚è¤‡é›‘ã«ãªã£ãŸã‚ã‚Šã«ã€ç‰¹ã«ãƒ¡ãƒªãƒƒãƒˆã‚‚ãªã„ï¼ˆShow å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãªã‚‰ãªã‚“ã§ã‚‚ c ã®ç®‡æ‰€ã«å–ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã“ã¨ãã‚‰ã„ï¼‰
    çµè«–ã€Car ã‚’å¤šç›¸å‹ã«ã—ã¦ã‚‚åŠ´åŠ›ã«è¦‹åˆã‚ãªã„ã¨ã„ã†ã“ã¨ã€‚

    ãµã¤ã†ã€å‹å¼•æ•°ã‚’ä½¿ã†ã®ã¯ã€ãƒ‡ãƒ¼ã‚¿å‹ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«åç´ã•ã‚ŒãŸå‹ãŒã€ãƒ‡ãƒ¼ã‚¿å‹è‡ªä½“ã®å‹•ä½œã«ãã“ã¾ã§é‡è¦ãªå½±éŸ¿ã‚’ä¸ãˆãªã„ã¨ãã§ã‚ã‚‹ã€‚
    ãŸã¨ãˆã°ã€Œç‰©ã€ã®ãƒªã‚¹ãƒˆã¯ã€ä¸­èº«ã®ç‰©ãŒãªã‚“ã§ã‚ã‚Œã€ã¨ã‚Šã‚ãˆãšãƒªã‚¹ãƒˆã¯ãƒªã‚¹ãƒˆã§ã‚ã‚‹ã€‚
    æ•°ã®ãƒªã‚¹ãƒˆã®åˆè¨ˆã‚’æ±‚ã‚ãŸããªã£ãŸã‚‰ã€ç‰¹ã«æ•°ã®ãƒªã‚¹ãƒˆã‚’å¼•æ•°ã«å–ã‚‹ç·å’Œé–¢æ•°ã‚’å¾Œã‹ã‚‰ä½œã‚Œã°ã„ã„ã‚ã‘ã§ã‚ã‚‹ã€‚
    Maybe ã«ã¤ã„ã¦ã‚‚åŒã˜ã“ã¨ãŒè¨€ãˆã‚‹ã€‚Maybe ã¯ã€ã‚ã‚‹ç‰©ã‚’ 1 ã¤æŒã¤ã‹æŒãŸãªã„ã‹ã®é¸æŠè‚¢ã‚’è¡¨ã—ã¦ã„ã‚‹ã®ã§ã‚ã£ã¦ã€ãã®ã‚‚ã®ãŒä½•å‹ã§ã‚ã‚‹ã‹ã¨ã¯é–¢ä¿‚ãªã„ã€‚

    ã“ã‚Œã¾ã§ã«å‡ºã¦ããŸä¸­ã§ã¯ã€Data.Map ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® Map k v ã‚‚å¤šå±¤å‹ã§ã‚ã‚‹ã€‚
    k ã¯ Map ã®ã‚­ãƒ¼ã®å‹ã§ã€v ã¯ Map ã®å€¤ã®å‹ã€‚
    ã“ã‚Œã¯å‹å¼•æ•°ãŒå¤§æ´»èºã§ãã¦ã„ã‚‹ä¾‹ã¨è¨€ãˆã‚‹ã€‚
    Map ãŒå¤šç›¸åŒ–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã§ã€ã©ã‚“ãªå‹ã‹ã‚‰ã©ã‚“ãªå‹ã¸ã® Map ã§ã‚‚ä½œã‚Œã‚‹ã€‚
    ã‚‚ã£ã¨ã‚‚ã€ã‚­ãƒ¼ã®å‹ã®ã»ã†ã¯ Ord ã«å±ã—ã¦ã„ã‚‹ã¨ã„ã†æ¡ä»¶ä»˜ãã§ã¯ã‚ã‚‹ãŒã€‚

    ã¨ã“ã‚ã§ã€Data.Map ã®ä½œè€…ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿å‹å®£è¨€ã«ã“ã†ã‚„ã£ã¦å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã‚’åŠ ãˆã‚‹ã¨ã„ã†é¸æŠã‚‚ã‚ã£ãŸã ã‚ã†ã€‚
        data (Ord k) => Map k v = ...
    ã—ã‹ã— Haskell ã«ã¯ã€_ãƒ‡ãƒ¼ã‚¿å®£è¨€ã«ã¯æ±ºã—ã¦å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã‚’ä»˜ã‘ãªã„_ ã¨ã„ã†ã€ã¨ã¦ã‚‚å¼·ã„ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ãŒã‚ã‚‹ã€‚
    ãªãœãªã‚‰ã€ãƒ‡ãƒ¼ã‚¿å®£è¨€ã«å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã‚’ä»˜ã‘ã¦ã‚‚å¤§ã—ãŸåˆ©ç›ŠãŒãªã„å‰²ã«ã€å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã‚’ãã“ã‚‰ä¸­ã€å¿…è¦ãªã„ç®‡æ‰€ã«ã¾ã§æ›¸ã„ã¦ã¾ã‚ã‚‹ç¾½ç›®ã«ãªã‚‹ã‹ã‚‰ã§ã‚ã‚‹ã€‚
    ã‚‚ã— Map k v ã®ãƒ‡ãƒ¼ã‚¿å®£è¨€ã« Ord k ã¨ã„ã†å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ãŒã‚ã£ã¦ã‚‚ã€Map ã®ã‚­ãƒ¼ãŒé †åºã¥ã‘å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’éç¨‹ã™ã‚‹é–¢æ•°ã«ã¯ã€ã‚„ã¯ã‚Šå‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã‚’æ›¸ãå¿…è¦ãŒã‚ã‚‹ã€‚
    ã“ã‚Œã«å¯¾ã—ã€ãƒ‡ãƒ¼ã‚¿å®£è¨€ã«å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ãŒãªã‘ã‚Œã°ã€ã‚­ãƒ¼ã®å‹ãŒé †åºã¥ã‘å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’ä»®å®šã—ãªã„é–¢æ•°ã‹ã‚‰ã¯ (Ord k) => ã‚’çœãã“ã¨ãŒã§ãã‚‹ã€‚
    ãã®ä¸€ä¾‹ãŒã€Map ã‚’å–ã£ã¦é€£æƒ³ãƒªã‚¹ãƒˆã«å¤‰æ›ã™ã‚‹é–¢æ•° toList ã§ã‚ã‚‹ã€‚ã“ã‚Œã®å‹ã‚·ã‚°ãƒãƒãƒ£ã¯
        toList :: Map k a -> [(k, a)]
    ã§ã‚ã‚‹ã€‚
    ã‚‚ã— Map k v ã®ãƒ‡ãƒ¼ã‚¿då®£è¨€ã«å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ãŒä»˜ã„ã¦ã„ãŸã‚‰ã€toList ã®å‹ã‚‚ toList :: (Ord k) => Map k a -> [(k, a)] ã¨ãªã‚‹å¿…è¦ãŒã‚ã£ãŸã ã‚ã†ã€‚
    toList é–¢æ•°è‡ªä½“ã¯ã‚­ãƒ¼ã®é †åºæ¯”è¼ƒã‚’ã¾ã£ãŸãä½¿ã‚ãªã„ã®ã«ã€‚

    ã¨ã„ã†ã‚ã‘ã§ã€ã“ã®ãƒ‡ãƒ¼ã‚¿å®£è¨€ã«ã¯ã“ã®å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã‚’ã¤ã‘ã‚‹ã®ãŒå½“ç„¶ã ã‚ã†ã€ã¨æ€ãˆã‚‹å ´åˆã§ã‚‚ã€æ±ºã—ã¦å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã‚’ä»˜ã‘ãªã„ã“ã¨ã€‚
    ã©ã®ã¿ã¡é–¢æ•°ã®å‹å®£è¨€ã«ã¯å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã‚’ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã ã‹ã‚‰ã€‚
-}

--- Â¶ ä¸‰æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«
{-
    ä¸‰æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã®å‹ã¨ã€ãƒ™ã‚¯ãƒˆãƒ«ã®æ¼”ç®—ã‚’ä½œã£ã¦ã¿ã‚ˆã†ã€‚ãƒ™ã‚¯ãƒˆãƒ«ã¯å¤šç›¸å‹ã«ã™ã‚‹ï¼ˆIntã€Doubleã€Flaot ãªã©è¤‡æ•°ã®å‹ã‚’ã‚µãƒãƒ¼ãƒˆã—ãŸã„ã‹ã‚‰ï¼‰ã€‚
-}

data Vector a = Vector a a a deriving (Show) 
    -- ä¸Šã§å­¦ã‚“ã ã¨ãŠã‚Šã€ã“ã“ã«ã¯ Num a => ã¿ãŸã„ãªå‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã¯æ›¸ã‹ãªã„ã€‚

vplus :: Num a => Vector a -> Vector a -> Vector a
(Vector i j k) `vplus` (Vector l m n) = Vector (i+l) (j+m) (k+n)

dotProd :: Num a => Vector a -> Vector a -> a
(Vector i j k) `dotProd` (Vector l m n) = i*l + j*m + k*n

vmult :: Num a => Vector a -> a -> Vector a
(Vector i j k) `vmult` m = Vector (i*m) (j*m) (k*m)

{-
    ä¸Šã®å¼ãŸã¡ã‚’è¦‹ã‚‹ã¨ã€ã“ã‚Œã‚‰ã®é–¢æ•°ã¯ Vector a ã¨ã„ã†å½¢ã§ã‚ã‚Œã°ã©ã‚“ãªå‹ã§ã‚‚æ‰±ãˆã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚
    ãŸã ã—ã€a ã¯ Num å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚ã‚‹ã¨ã„ã†æ¡ä»¶ä»˜ãã€‚
    ãƒ‡ãƒ¼ã‚¿å®£è¨€ã«ã¯ Num å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã¯ã¤ã‹ãšã€çµå±€ã€ï¼ˆä»®ã«ãƒ‡ãƒ¼ã‚¿å®£è¨€ã«å‹åˆ¶ç´„ã‚’ã¤ã‘ãŸã¨ã“ã‚ã§ï¼‰é–¢æ•°å†…ã®å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ï¼ˆNumï¼‰ã‚’çœãã“ã¨ã¯ã§ããªã„ã®ã§ã‚ã‚‹ã€‚

    å¿µæŠ¼ã—ã ãŒã€å‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’åŒºåˆ¥ã—ã¦ãŠãã“ã¨ã¯ã¨ã¦ã‚‚é‡è¦ã§ã‚ã‚‹ã€‚
    ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®£è¨€ã™ã‚‹ã¨ãã€= ã®å‰ã«ã‚ã‚‹ã®ãŒå‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚ã‚Šã€å¾Œã‚ã«ã‚ã‚‹ï¼ˆã‚ã‚‹ã„ã¯ | ã§åŒºåˆ‡ã‚‰ã‚ŒãŸãã®å¾Œã‚ã«ã‚ã‚‹ï¼‰ã®ãŒå€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚ã‚‹ã€‚
    ãŸã¨ãˆã°ã€é–¢æ•°ã«ã“ã®ã‚ˆã†ãªå‹ã‚’ä¸ãˆã‚‹ã®ã¯é–“é•ã„ã€‚
        Vector a a a -> Vector a a a -> a
    ã“ã‚ŒãŒå‹•ã‹ãªã„ã®ã¯ã€ãƒ™ã‚¯ãƒˆãƒ«ã®å‹ã¯ Vector a ã§ã‚ã£ã¦ã€Vector a a a ã§ã¯ãªã„ã‹ã‚‰ã§ã‚ã‚‹ã€‚
    ãƒ™ã‚¯ãƒˆãƒ«ã¯ã€å‹ã¨ã—ã¦ã¯ã‚ãã¾ã§å¼•æ•°ã‚’ 1 ã¤ã ã‘å–ã‚‹ã€‚å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯ 3 ã¤ã®å¼•æ•°ã‚’å–ã‚‹ãŒã€ãã‚Œã¯åˆ¥ã®è©±ã§ã‚ã‚‹ã€‚
        data Vector a = Vector a a a deriving (Show)
        å‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã€€ã€€ã“ã£ã¡ãŒå€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
-}

-- ä½œã£ãŸãƒ™ã‚¯ãƒˆãƒ«ã§éŠã‚“ã§ã¿ã‚ˆã†ã€‚
vecSum :: Num a => Vector a
vecSum = Vector 3 5 8 `vplus` Vector 9 2 8 -- Vector 12 7 16

threeVecSum :: Num a => Vector a
threeVecSum = Vector 3 5 8 `vplus` Vector 9 2 8 `vplus` Vector 0 2 3 -- Vector 12 9 19

multedVec :: Num a => Vector a
multedVec = Vector 3 9 7 `vmult` 10 -- Vector 30 90 70

proded :: Num a => a
proded = Vector 4 9 5 `dotProd` Vector 9 2 4 -- 74

calcedVec :: Num a => Vector a
calcedVec = Vector 2 9 3 `vmult` (Vector 4 9 5 `dotProd` Vector 9 2 4) -- Vector 148 666 222

-------------------------------
-- ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®è‡ªå‹•å°å‡º
-------------------------------

{-
    å‹ã‚¯ãƒ©ã‚¹ã«ã¤ã„ã¦æ”¹ã‚ã¦å¾©ç¿’ï¼šå‹ã‚¯ãƒ©ã‚¹ã¯ã€ã‚ã‚‹ãµã‚‹ã¾ã„ã‚’å®šç¾©ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã‚ã‚Šã€ã‚ã‚‹å‹ãŒãã®æŒ¯ã‚‹èˆã„ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚Œã°ã€
    ãã®å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã§ãã‚‹ã®ã ã£ãŸã€‚ãŸã¨ãˆã°ã€Int å‹ã¯ Eq å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚ã‚‹ã€‚
    ã“ã‚Œã¯ã€Eq å‹ã‚¯ãƒ©ã‚¹ã¯ã€Œç­‰å€¤ç”Ÿãƒ†ã‚¹ãƒˆãŒã§ãã‚‹ã‚‚ã®ã€ã¨ã„ã†æŒ¯ã‚‹èˆã„ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã‚ã‚‹ã€‚
    æ•´æ•°ã«ã¯ç­‰å€¤æ€§ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ã‚‰ã€Int ã¯ Eq å‹ã‚¯ãƒ©ã‚¹ã«å±ã™ã‚‹ã“ã¨ã«ãªã‚‹ã€‚
    ã“ã‚ŒãŒä¾¿åˆ©ãªã®ã¯ã€Eq ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ãªã‚‹ã€== ã¨ /= ã¨ã„ã†é–¢æ•°ãŒã‚ã‚‹ã‹ã‚‰ã§ã‚ã‚‹ã€‚
    ã‚ã‚‹å‹ãŒ Eq å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚ã‚‹ãªã‚‰ã€ãã®å‹ã®å€¤ã«ã¯ == ãŒä½¿ãˆã‚‹ã€‚
    ã“ã‚Œã“ããŒã€ 4 == 4 ã¨ "foo" == "bar" ãŒä¸¡æ–¹ã¨ã‚‚å‹æ¤œæŸ»ã‚’é€ä»•çµ„ã¿ã§ã‚ã‚‹ã€‚

    Haskell ã®å‹ã‚¯ãƒ©ã‚¹ã¯ã€Javaã€Pythonã€C++ ã¨ã„ã£ãŸè¨€èªã®ã€Œã‚¯ãƒ©ã‚¹ã€ã¨ç´›ã‚‰ã‚ã—ã„ã®ã§ã€å¼•ã£ã‹ã‹ã‚Šã‚„ã™ã„ã¨ã“ã‚ã§ã‚ã‚‹ã€‚
    ãã†ã„ã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨€èªã§ã‚¯ãƒ©ã‚¹ã¨ã„ãˆã°ã€ä½•ã‚‰ã‹ã®å‹•ä½œã‚’ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹ãŸã‚ã®é’å†™çœŸã®ã“ã¨ã§ã‚ã‚‹ã€‚
    ã—ã‹ã—ã€Haskell ã®ã‚¯ãƒ©ã‚¹ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ä½œã‚‹é“å…·ã§ã¯ãªã„ã€‚
    ãã†ã§ã¯ãªãã€ã¾ãšãƒ‡ãƒ¼ã‚¿å‹ã‚’ä½œã‚Šã€ãã‚Œã‹ã‚‰ã€Œã“ã®ãƒ‡ãƒ¼ã‚¿ã«ã¯ä½•ãŒã§ãã‚‹ã®ã ã‚ã†ï¼Ÿã€ã¨è€ƒãˆã‚‹ã®ã§ã‚ã‚‹ã€‚
    ã‚‚ã—ãã®å‹ãŒã€ç­‰å€¤æ€§ã‚’ãƒ†ã‚¹ãƒˆã§ãã‚‹ã‚‚ã®ã§ã‚ã‚Œã°ã€Eq å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã™ã‚‹ã€‚
    ãã®å‹ãŒä»£å„Ÿæ¯”è¼ƒã§ãã‚‹ã‚‚ã®ã§ã‚ã‚Œã°ã€Ord å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã™ã‚‹ã€‚

    Haskell ã¯ã€ç‰¹å®šã®å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å®£è¨€ã‚’è‡ªå‹•å°å‡ºï¼ˆderiveï¼‰ã™ã‚‹èƒ½åŠ›ã‚’å‚™ãˆã¦ã„ã‚‹ã€‚
    è‡ªå‹•å°å‡ºã§ãã‚‹å‹ã‚¯ãƒ©ã‚¹ã¯ Eqã€Ordã€Enumã€Boundedã€Showã€Read ã§ã‚ã‚‹ã€‚
    è‡ªä½œã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’ä½œã‚‹ã¨ãã€deriving ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ãˆã°ã€Haskell ãŒã“ã‚Œã‚‰ã®å‹ã‚¯ãƒ©ã‚¹ã®æ–‡è„ˆã§ã®æŒ¯ã‚‹èˆã„ã‚’è‡ªå‹•å°å‡ºã—ã¦ãã‚Œã‚‹ã€‚
-}

--- Â¶ã€€äººé–“ã®å¹³ç­‰
{- ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿å‹ã‚’è¦‹ã‚ˆã€‚-}

{-
data Person_ = Person_ { firstName_ :: String
                       , lastName_ :: String
                       , age_ :: Int
                       }
-}

{-
    ã“ã‚Œã¯äººé–“ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚ã„ã¾ã€ã“ã®ä¸–ã«åŒå§“åŒåã§å¹´é½¢ã¾ã§ä¸€è‡´ã™ã‚‹äººã¯ã„ãªã„ã€ã¨ä»®å®šã—ã‚ˆã†ã€‚
    ã§ã¯ã€äºŒäººã®äººã®è¨˜éŒ²ãŒã‚ã‚‹ã¨ãã€ãã® 2 ã¤ã®è¨˜éŒ²ãŒåŒä¸€äººç‰©ã‚’è¡¨ã—ã¦ã„ã‚‹ã‹åˆ¤å®šã™ã‚‹ã“ã¨ã¯å¦¥å½“ã ã‚ã†ã‹ã€‚
    ã‚‚ã¡ã‚ã‚“ã€åˆ¤å®šã§ãã¦ã—ã‹ã‚‹ã¹ãã§ã‚ã‚‹ã€‚
    ã ã‹ã‚‰ã€ã“ã®å‹ã‚’ Eq å‹ã‚¯ãƒ©ã‚¹ã«å±ã•ã›ã‚‹ã®ã¯å¦¥å½“ãªã“ã¨ã ã‚ã†ã€‚
    ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å®£è¨€ã¯è‡ªå‹•å°å‡ºã—ã¦ã‚‚ã‚‰ãŠã†ã€‚
-}

data Person_ = Person_ { firstName_ :: String
                       , lastName_ :: String
                       , age_ :: Int
                       } deriving (Eq)

{-
    ã‚ã‚‹å‹ã« Eq ã‚’è‡ªå‹•å°å‡ºã—ã¦ == ã‚„ /= ã§æ¯”è¼ƒã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€Haskell ã¯ã¾ãšå€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹ã‚’èª¿ã¹ã‚‹ã€‚
    ãã‚Œã‹ã‚‰ã€å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ä¸­ã«å…¥ã£ã¦ã„ã‚‹å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã™ã¹ã¦ä¸€è‡´ã—ã¦ã„ã‚‹ã‹ã€ãã‚Œãã‚Œã®çµ„ã¿ã‚’ == ã‚’ä½¿ã£ã¦æ¯”è¼ƒã™ã‚‹ã€‚
    ãŸã ã—è½ã¨ã—ç©´ãŒ 1 ã¤ã‚ã‚‹ã€‚
    ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹ãŒã€Eq å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿æˆã™ã§ãªã„ã¨è‡ªå‹•ã©ã†shã¤ã«ã¯ä½¿ãˆãªã„ã€‚
    ä»Šå›ã®å ´åˆã¯ã€String ã‚‚ Int ã‚‚ã“ã®æ¡ä»¶ã‚’æº€ãŸã™ã‹ã‚‰ OK ã§ã‚ã‚‹ã€‚

    ã¾ãšã¯äººç‰©ã‚’ä½•äººã‹ä½œã£ã¦ã¿ã‚ˆã†ã€‚
-}

mikeD :: Person_
mikeD = Person_ {firstName_ = "Michael", lastName_ = "Diamond", age_ = 43}

adRock :: Person_
adRock = Person_ {firstName_ = "Adam", lastName_ = "Horovitz", age_ = 41}

mca :: Person_
mca = Person_ {firstName_ = "Adam", lastName_ = "Yauch", age_ = 44}

{-
    Eq ã‚’è‡ªå‹•å°å‡ºã—ãŸã“ã¨ã«ã‚ˆã‚Šã€
    mca == adRock ã‚„ mikeD == adRockã€mikeD == mikeD ãŒæ„å‘³ã‚’æŒã¤ã‚ˆã†ã«ãªã‚‹ã€‚
    ï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«æ‰“ã¡è¾¼ã‚€ã¨ãã‚Œãã‚Œ False, False, True ã¨è¿”ã£ã¦ãã‚‹ï¼‰

    ã‚‚ã¡ã‚ã‚“ã€Eq a ã¨ã„ã†å‹ã‚¯ãƒ©ã‚¹åˆ¶ç´„ã®ã¤ã„ãŸé–¢æ•°ã® a ã®ã¨ã“ã‚ãªã‚‰ã©ã“ã«ã§ã‚‚ä½¿ãˆã‚‹ã€‚ãŸã¨ãˆã° elem ãªã©ã€‚
    mikeD `elem` [mca, adRock, mikeD]
    > True
-}

--- Â¶ã€€èª­ã¿æ–¹ã‚’æ›¸ã„ã¦ã¿ã›ã¦ã‚ˆ
{-
    Show ã¨ Read ã¯ãã‚Œãã‚Œæ–‡å­—åˆ—ã¸å¤‰æ›ã§ãã‚‹ã‚‚ã®ã®å‹ã‚¯ãƒ©ã‚¹ã€ãŠã‚ˆã³æ–‡å­—åˆ—ã‹ã‚‰å¤‰æ›ã§ãã‚‹ã‚‚ã®ã®å‹ã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹ã€‚
    Eq ã®ã¨ãã¨åŒã˜ãã€ã‚ã‚‹å‹ã‚’ Show ã‚„ã€€Read ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã—ãŸã„ãªã‚‰ã€ãã®å‹ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Œã°ã€
    ãã‚Œã‚‰ã®å‹ã‚‚ Show ã‚„ Read ã«å±ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

    ã§ã¯ã€Person_ ãƒ‡ãƒ¼ã‚¿å‹ã‚’ Show ã¨ Read ã«ã‚‚å±ã•ã›ã¦ã¿ã‚ˆã†ã€‚
-}

data Person__ = Person__ { firstName__ :: String
                        ,  lastName__ :: String
                        ,  age__ :: Int
                        } deriving (Eq, Show, Read)

{- ã“ã‚Œã§äººç‰©ã®æƒ…å ±ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å‡ºåŠ›ã§ãã‚‹ã€‚ -}

mikeD' :: Person__
mikeD' = Person__ {firstName__ = "Michael", lastName__ = "Diamond", age__ = 43}

adRock' :: Person__
adRock' = Person__ {firstName__ = "Adam", lastName__ = "Horovitz", age__ = 41}

mca' :: Person__
mca' = Person__ {firstName__ = "Adam", lastName__ = "Yauch", age__ = 44}

{-
    deriving Read ã‚‚ã—ã¦ã„ã‚‹ã®ã§ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ä»¥ä¸‹ã®ã‚ˆã†ã«ä¹³å³åŠ›ã™ã‚‹ã¨ã€Person__ å‹ã¨ã—ã¦å‡ºåŠ›ã‚’è¿”ã—ã¦ãã‚Œã‚‹ã€‚
        > read "Person__ {firstName__ = \"Mike\", lastName__ = \"Diablo\", age__ = 23}" :: Person__
        Person__ {firstName__ = "Mike", lastName__ = "Diablo", age__ = 23}

    å¤šç›¸å‹ã‚‚èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã‚‹ãŒã€ã©ã®å‹ãŒã»ã—ã„ã‹ Haskell ãŒæ¨è«–ã§ãã‚‹ã ã‘ã®æƒ…å ±ã‚’ä¸ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã®ã‚’è©¦ã™ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚
        read "Just 3" :: Maybe a
    æ­£ã—ãã¯ã€read "Just 3" :: Maybe Int ãªã©ã¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼ˆMaybe Double ã¨ã‹ Maybe Float ã§ã‚‚ã‚ˆã„ï¼‰ã€‚
-}

--- Â¶ã€€é †ç•ªã‚’å®ˆã£ã¦ãã ã•ã„ï¼
{-
    é †åºã¥ã‘å¯èƒ½ãªå‹ã®ãŸã‚ã®å‹ã‚¯ãƒ©ã‚¹ã€Ord ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚‚è‡ªå‹•å°å‡ºã§ãã‚‹ã€‚åŒã˜å‹ã®å€¤ã‚’ 2 ã¤æ¯”è¼ƒã—ãŸã¨ãã€ã‚‚ã— 2 ã¤ãŒç•°ãªã‚‹å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‹ã‚‰ä½œã‚‰ã‚ŒãŸç‰©ãªã‚‰ã€
    å…ˆã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã»ã†ãŒå°ã•ã„ã¨ã¿ãªã•ã‚Œã‚‹ã€‚
    ä¾‹ãˆã°ã€Bool ã¯ False ã¨ True ã®å€¤ã‚’å–ã‚‹ã€‚Bool ã‚’æ¯”è¼ƒã™ã‚‹ã¨ä½•ãŒèµ·ã“ã‚‹ã‹ã¯ã€Bool ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã¨è€ƒãˆã‚Œã°ã‚ã‹ã‚‹ã€‚
        data Bool = False | True deriving (Ord)
    False å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒå…ˆã«å®šç¾©ã•ã‚Œã¦ã„ã¦ã€ãã®å¾Œã§ True ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã®ã§ã€Ord ã‚’è‡ªå‹•å°å‡ºã™ã‚‹ã¨ã€True ã¯ False ã‚ˆã‚Šå¤§ãã„ã®ã ã‚ã†ã¨è€ƒãˆã‚‰ã‚Œã‚‹ã€‚
-}

comp1 :: Ordering
comp1 = True `compare` False -- GT

comp2 :: Bool
comp2 = True > False -- True

{-
    2 ã¤ã®å€¤ãŒåŒã˜å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã§ãã¦ã„ã‚‹å ´åˆã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãªã‘ã‚Œã° 2 ã¤ã¯ç­‰ã—ã„ã¨ã•ã‚Œã‚‹ã€‚
    ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Œã°ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã©ã†ã—ãŒæ¯”è¼ƒã•ã‚Œã€ã©ã¡ã‚‰ãŒå¤§ãã„ã‹æ±ºã¾ã‚‹ï¼ˆã“ã®å ´åˆã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‹ã‚‚ã¾ãŸ Ord ã«å±ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼‰ã€‚

    Maybe a ãƒ‡ãƒ¼ã‚¿å‹ã§ã¯ã€Nothing å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒ Just å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å‰ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€Nothing å€¤ã¯ã¤ã­ã« Just something ã‚ˆã‚Šå°ã•ã„ã¨ã•ã‚Œã‚‹ã€‚
    ä¸€æ–¹ã€2 ã¤ã® Just å€¤ã‚’æŒ‡å®šã—ãŸã¨ãã¯ã€Haskell ã¯ä¸­èº«ã‚’æ¯”è¼ƒã—ã¦ãã‚Œã‚‹ã€‚

    ã§ã‚‚ã€Just (*3) > Just (*2) ã®ã‚ˆã†ãªã“ã¨ã¯ã§ããªã„ã€‚(*3) ãªã©ã¯é–¢æ•°ã®å‹ã‚’æŒã¡ã€é–¢æ•°ã¯ Ord ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã¯ãªã„ã‹ã‚‰ã€‚
-}

comp3 :: Bool
comp3 = Nothing < Just (100 :: Int) -- True

comp4 :: Bool
comp4 = Nothing > Just (-999999 :: Integer) -- False

comp5 :: Ordering
comp5 = Just (3 :: Int) `compare` Just (2 :: Int) -- GT

comp6 :: Bool
comp6 = Just (100 :: Int) > Just (50 :: Int) -- True

--- Â¶ ä½•æ›œæ—¥ã§ã‚‚ã„ã„ã‚ˆ
{-
    ä»£æ•°ãƒ‡ãƒ¼ã‚¿å‹ã‚’ä½¿ãˆã°åˆ—æŒ™å‹ã¯ç°¡å˜ã«ä½œã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
    ãã®éš›ã«ã¯ Enum ã¨ Bounded å‹ã‚¯ãƒ©ã‚¹ãŒä¾¿åˆ©ã€‚ã“ã‚“ãªãƒ‡ãƒ¼ã‚¿å‹ã‚’è€ƒãˆã¦ã¿ã‚ˆã€‚

        data Day = Monday | Tuesday | Wednesday | Thursday | Friday | Saturday | Sunday

    ã™ã¹ã¦ã®å€¤ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒã‚¼ãƒ­å¼•æ•°ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãªã„ï¼‰ãªã®ã§ã€ã“ã‚Œã‚’ Enum å‹ã‚¯ãƒ©ã‚¹ã«å±ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
    Enum ã¯ã€å‰è€…é–¢æ•°ï¼ˆpredï¼‰ã¨å¾Œè€…é–¢æ•°ï¼ˆsuccï¼‰ã‚’æŒã¤å‹ã®ãŸã‚ã®å‹ã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹ã€‚
    Day ã¯ä¸Šé™ã¨ä¸‹é™ã‚’æŒã¤å‹ã®å‹ã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹ Bounded ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚‚ã§ãã‚‹ã€‚
    ã¤ã„ã§ã«è‡ªå‹•å°å‡ºã§ãã‚‹ã™ã¹ã¦ã®å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã—ã¦ã—ã¾ãŠã†ã€‚
-}

data Day = Monday | Tuesday | Wednesday | Thursday | Friday | Saturday | Sunday
        deriving (Eq, Ord, Show, Read, Bounded, Enum)

--ã€€Day å‹ã§ä½•ãŒã§ãã‚‹ã®ã‹ï¼Ÿ
{-
    Day ã¯ Show ã¨ Read ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚ã‚‹ã‹ã‚‰ã€ãã®å€¤ã‚’æ–‡å­—åˆ—ã«ã—ãŸã‚Šæ–‡å­—åˆ—ã‹ã‚‰å¤‰æ›ã—ãŸã‚Šã§ãã‚‹ã€‚
    Wednesday
    > Wednesday

    show Wednesday
    > "Wednesday"

    read "Wednesday" :: Day
    > Wednesday

    Eq å‹ã‚¯ãƒ©ã‚¹ã¨ Ord å‹ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚‚ã‚ã‚‹ã®ã§ã€ç­‰å·ã‚„ä¸ç­‰å·ã§æ¯”è¼ƒã§ãã‚‹ã€‚
    Saturday == Sunday
    > False

    Saturday == Saturday
    > True

    Saturday > Friday
    > True

    Monday `compare` Wednesday
    > LT

    ã•ã‚‰ã«ã€Bounded ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚‚ã‚ã‚‹ã‹ã‚‰ã€ä¸Šé™ã¨ä¸‹é™ã‚’å–ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚
-}

minBoundOfDay :: Day
minBoundOfDay = minBound :: Day -- Monday

maxBoundOfDay :: Day
maxBoundOfDay = maxBound :: Day -- Sunday

{-
    Enum ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚‚ã‚ã‚‹ã®ã§ã€æ˜¨æ—¥ã®æ›œæ—¥ã‚„æ˜æ—¥ã®æ›œæ—¥ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã‚‹ã—ã€ç¯„å›²ã‚’æŒ‡å®šã—ã¦ãƒªã‚¹ãƒˆã‚’ä½œã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚
-}

afterMon :: Day
afterMon = succ Monday -- Tuesday

beforeSat :: Day
beforeSat = pred Saturday -- Tuesday

daysList :: [Day]
daysList = [Thursday .. Sunday] -- [Thursday,Friday,Saturday,Sunday]

week :: [Day]
week = [minBound .. maxBound] -- [Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday]